%!TEX root = ../../../_main.tex
\section{Introduction to twisted involutions}
\label{sec:twisted-involutions-introduction}

Twisted involutions generalize the property of being involutive with respect to an involutory automorphism $\theta$. For $\theta = \id$ the set of $\theta$-twisted involutions, denoted by $\ti{\theta}$ coincides with the set of ordinary involutions in $W$ (cf. \ref{exam:id-twisted-involutions}). As we will see the set of this $\theta$-twisted involutions equals the $e$-orbit of a special action, defined in \ref{defi:twisted-operation}. For $\ti{\theta}$ and the mentioned map many properties of ordinary Coxeter groups hold. In particular there is an analogue to the \ref{coro:exchange-condition} and \ref{coro:deletion-condition}.

\begin{defi}
	An automorphism $\theta : W \to W$ with $\theta(S) = S$ is called a \defword{Coxeter system automorphism} of $(W,S)$. We always assume $\theta^2 = \id$.
\end{defi}

\begin{defi}
	We define the \defword{set of $\theta$-twisted involutions} of $W$ as
	$$ \ti{\theta}(W) := \{ w \in W : \theta(w) = w^{-1} \}. $$
	If $\theta$ is clear from the context we just say \defword{set of twisted involutions}. Every element $w \in \ti{\theta}(W)$ is called a \defword{$\theta$-twisted involution}, resp. \defword{twisted involution}. Often, when $W$ is clear from the context, we will omit it and just write $\ti{\theta}$.
\end{defi}

\begin{exam}
	\typedlabel{exam:id-twisted-involutions}
	Let $\theta = \id_W$. Then $\theta$ is a Coxeter system automorphism and the set of all $\id$-twisted involutions coincides with the set of all ordinary involutions of $W$.
\end{exam}

The next example is more helpful, since it reveals a way to think of $\ti{\theta}$ as a generalization of ordinary Coxeter groups.

\begin{exam}
	\typedlabel{exam:bijection-between-coxeter-groups-and-set-of-twisted-involutions}
	\theocite{Example 3.2}{hultman:comb-twisted-invo}
	Let $\theta$ be an automorphism of $W \times W$ with $\theta : (u,w) \mapsto (w,u)$. Then $\theta$ is a Coxeter system automorphism of the Coxeter system $(W \times W, S \times S)$ and the set of twisted involutions is
	$$ \ti{\theta} = \{ (w,w^{-1}) \in W \times W : w \in W \}. $$
	This yields a canonical bijection between $\ti{\theta}$ and $W$.
\end{exam}

\begin{defi}
	\typedlabel{defi:twisted-operation}
	Let $\ul S := \{ \ul s : s \in S \}$ be a set of symbols. Each element in $\ul S$ acts from the right on $W$ by the following definition:
	$$ w \ul s = \begin{cases}
		ws & \textrm{if } \theta(s)ws = w, \\
		\theta(s)ws & \textrm{else}. \\
	\end{cases} $$
	This action can be extended on the whole free monoid over $\ul S$ by
	$$ w \ul s_1 \ul s_2 \ldots \ul s_k = (\ldots ((w \ul s_1) \ul s_2) \ldots) \ul s_k. $$
	If $w \ul s = \theta(s)ws$, then we say $\ul s$ \defword{acts by twisted conjugation} on $w$. Else we say $\ul s$ \defword{acts by multiplication} on $w$.
\end{defi}

Note that this is no group action. For example, let $W$ be a Coxeter group with two generators $s,t$ satisfying $\ord(st) = 3$ and let $\theta = \id$. Then $sts = tst$, but
$$ e \ul s \ul t \ul s = s \ul t \ul s = tst \ul s = sts \ul s = t \neq s = tst \ul t = sts \ul t = t \ul s \ul t = e \ul t \ul s \ul t. $$

\begin{defi}
	\typedlabel{defi:twisted-expression}
	Let $k \in \nn$ and $s_{i} \in S$ for all $1 \leq i \leq k$. Then an expression $e \ul s_1 \ldots \ul s_k$, or just $\ul s_1 \ldots \ul s_k$, is called \defword{$\theta$-twisted expression}. If $\theta$ is clear from the context, we omit $\theta$ and call it \defword{twisted expression}. A twisted expression is called \defword{reduced twisted expression} if there is no $k' < k$ with $\ul s'_1 \ldots \ul s'_{k'} = \ul s_1 \ldots \ul s_k$.
\end{defi}

\begin{lemm}
	\typedlabel{lemm:twisted-operation-2}
	\theocite{Lemma 3.4}{hultman:comb-twisted-invo}
	Let $w \in \ti{\theta}$ and $s \in S$. Then
	$$ w \ul s = \begin{cases}
		ws & \textrm{if } l(\theta(s)ws) = l(w), \\
		\theta(s)ws & \textrm{else}. \\
	\end{cases} $$

	\begin{proof}
		\proofcite{Lemma 3.4}{hultman:comb-twisted-invo}
		We reproduce the proof from loc. cit. here., since it is interesting from a technical point of view. Suppose $\ul s$ acts by multiplication on $w$. Then $\theta(s)ws = w$ and so $l(\theta(s)ws) = l(w)$. Conversely, suppose $l(\theta(s)ws) = l(w)$. If $w \ul s = ws$, then we are done. So assume $\theta(s)ws \neq w$. Then $w$ must have a reduced expression beginning with $\theta(s)$ or ending with $s$ (else, we could not have $l(\theta(s)ws) = l(w)$). Without loss of generality suppose that $\theta(s)s_1 \cdots s_k$ is such an expression for $w$. Since $w$ is a $\theta$-twisted involution, i.e. $\theta(w) = w^{-1}$, we have $l(ws) < l(w)$. Since $l(\theta(s)ws) = l(w)$, no reduced expression for $w$ both begins with $\theta(s)$ and ends with $s$ and hence \ref{coro:exchange-condition} yields $ws = s_1 \cdots s_k$, which implies $\theta(s)ws = w$, contradicting to our assumption.
	\end{proof}
\end{lemm}

\begin{lemm}
	\typedlabel{lemm:l-ws-lower-l-w-iff-l-w-ul-s-lower-l-w}
	We have $l(ws) < l(w)$ iff $l(w \ul s) < l(w)$.

	\begin{proof}
		Suppose $\ul s$ acts by multiplication on $w$. Then $w \ul s = ws$ and there is nothing to prove. So suppose $\ul s$ acts by twisted conjugation on $w$. If $l(ws) < l(w)$, then \ref{lemm:length-function-properties} yields $l(ws) + 1 = l(w)$. Assuming $l(w \ul s) = l(\theta(s)ws) = l(w)$ would imply that $\ul s$ acts by multiplication on $w$ due to \ref{lemm:twisted-operation-2}, which is a contradiction. So $l(w \ul s) = l(\theta(s)ws) < l(w)$. Conversely, suppose $l(w \ul s) < l(w)$. Then \ref{lemm:length-function-properties} says $l(w \ul s) = l(\theta(s)ws) = l(w) - 2$ and so $l(ws) = l(w) - 1$.
	\end{proof}
\end{lemm}

\begin{lemm}
	\typedlabel{lemm:w-ul-ss-eq-w}
	For all $w \in W$ and $s \in S$ we have $w \ul s \ul s = w$.

	\begin{proof}
		For $w \ul s$ there are two cases. Suppose $\ul s$ acts by multiplication on $w$, i.e. $\theta(s)ws = w$. For $ws \ul s$ there are again two possible options:
		$$ ws \ul s = \begin{cases}
			wss = w & \textrm{if } \theta(s)wss = ws, \\
			\theta(s)wss = ws & \textrm{else}. \\
		\end{cases} $$
		The second option contradicts itself.

		Now suppose $\ul s$ acts by twisted conjugation on $w$. This means $\theta(s)ws \neq w$ and for $(\theta(s)ws) \ul s$ there are again two possible options:
		$$ (\theta(s)ws) \ul s = \begin{cases}
			\theta(s)wss = \theta(s)w & \textrm{if } \theta(s) \theta(s) w ss = \theta(s) w s, \\
			\theta(s)\theta(s)wss = w & \textrm{else}. \\
		\end{cases} $$
		The first option is impossible since $\theta(s) \theta(s) w ss = w$ and we have assumed $\theta(s)ws \neq w$. Hence, the only possible cases yield $w \ul s \ul s = w$.
	\end{proof}
\end{lemm}

\begin{rema}
	\ref{lemm:w-ul-ss-eq-w} allows us to rewrite equations of twisted expressions. For example
	$$ u = w \ul s \iff u \ul s = w \ul s \ul s = w. $$
	This can be iterated to get
	$$ u = w \ul s_1 \ldots \ul s_k \iff u \ul s_k \ldots \ul s_1 = w. $$
\end{rema}

\begin{lemm}
	\typedlabel{lemm:w-in-ti-iff-w-ul-s-in-ti}
	For all $\theta$, $w \in W$ and $s \in S$ it holds that $w \in \ti{\theta}$ iff $w \ul s \in \ti{\theta}$.

	\begin{proof}
		Let $w \in \ti{\theta}$. For $w \ul s$ there are two cases. Suppose $\ul s$ acts by multiplication on $w$. Then we get
		$$ \theta(ws) = \theta(\theta(s)wss) = \theta^2(s) \theta(w) = sw^{-1} = (ws^{-1})^{-1} = (ws)^{-1}. $$
		Suppose $\ul s$ acts by twisted conjugation on $w$. Then we get
		$$ \theta(\theta(s)ws) = \theta^2(s) \theta(w) \theta(s) = sw^{-1}\theta(s) = (\theta^{-1}(s)ws^{-1})^{-1} = (\theta(s)ws)^{-1}. $$
		In both cases $w \ul s \in \ti{\theta}$.

		Now let $w \ul s \in \ti{\theta}$. Suppose $\ul s$ acts by multiplication on $w$. Then
		$$ \theta(w) = \theta(\theta(s)ws) = \theta^2(s)\theta(ws) = s (ws)^{-1} = ss^{-1}w^{-1} = w^{-1}. $$
		Suppose $\ul s$ acts by twisted conjugation on $w$. Then
		\begin{align*}
			\theta(w)	& = \theta(\theta(s)\theta(s)wss) = \theta^2(s) \theta(\theta(s)ws) \theta(s) \\
						& = s (\theta(s)ws)^{-1} \theta(s) = s(s^{-1} w^{-1} \theta(s^{-1}) \theta(s) = w^{-1}.
		\end{align*}
		In both cases $w \in \ti{\theta}$.
	\end{proof}
\end{lemm}

A remarkable property of the action from \ref{defi:twisted-operation} is its $e$-orbit. As the following lemma shows, it coincides with $\ti{\theta}$.

\begin{lemm}
	\typedlabel{lemm:twisted-e-orbit-coincides-with-twisted-involutions}
	\theocite{Proposition 3.5}{hultman:comb-twisted-invo}
	The set of $\theta$-twisted involutions coincides with the set of all $\theta$-twisted expressions.

	\begin{proof}
		By \ref{lemm:w-in-ti-iff-w-ul-s-in-ti}, each twisted expression is in $\ti{\theta}$, since $e \in \ti{\theta}$. So let $w \in \ti{\theta}$. If $l(w) = 0$, then $w = e \in \ti{\theta}$. So assume $l(w) = r > 0$ and that we have already proven that every twisted involution $w' \in \ti{\theta}$ with $\rho(w') < r$ has a twisted expression. If $w$ has a reduced twisted expression ending with $\ul s$, then $w$ also has a reduced expression (in $S$) ending with $s$ and so $l(ws) < l(w)$. With \ref{lemm:l-ws-lower-l-w-iff-l-w-ul-s-lower-l-w} we get $l(w \ul s) < l(w)$. By induction $w \ul s$ has a twisted expression and hence $w = (w \ul s) \ul s$ has one, too.
	\end{proof} 
\end{lemm}

In the same way, we can use regular expressions to define the length of an element $w \in W$, we can use the twisted expressions to define the twisted length of an element $w \in \ti{\theta}$.

\begin{defi}
	Let $\ti{\theta}$ be the set of twisted involutions. Then we define $\rho(w)$ as the smallest $k \in \nn$ for that a twisted expression $w = \ul s_1 \ldots \ul s_k$ exists. This is called the \defword{twisted length} of $w$.
\end{defi}

\begin{lemm}
	\theocite{Theorem 4.8}{hultman:bruhat-order}
	The Bruhat ordering, restricted to the set of twisted involutions $\ti{\theta}$, is a graded poset with $\rho$ as rank function. We denote this poset by $\Br(\ti{\theta})$.
\end{lemm}

We now establish many properties from ordinary Coxeter groups for twisted expressions and $\Br(\ti{\theta})$. As seen in \ref{exam:bijection-between-coxeter-groups-and-set-of-twisted-involutions} there is a Coxeter system $(W',S')$ and a Coxeter system automorphism $\theta$ with $\Br(W) \cong \Br(\ti{\theta}(W'))$. So the hope that many properties can be transfered is eligible.

\begin{lemm}
	\typedlabel{lemm:rho-w-ul-s-minus-rho-w-differs-by-1}
	\theocite{Lemma 3.8}{hultman:comb-twisted-invo}
	Let $w \in \ti{\theta}$ and $s \in S$. Then $\rho(w \ul s) = \rho(w) \pm 1$. In fact it is $\rho(w \ul s) = \rho(w) - 1$ iff $s \in D_R(w)$.
\end{lemm}

\begin{lemm}[Lifting Property for twisted expressions]
	\namedlabel{lemm:lifting-property-for-ul-s}
	\theocite{Lemma 3.9}{hultman:comb-twisted-invo}
	Let $v,w \in W$ with $v \leq w$. Suppose $s \in S$ with $s \in D_R(w)$. Then
	\begin{enumerate}
		\item $v \ul s \leq w$,
		\item $s \in D_R(v) \Rightarrow v \ul s \leq w \ul s$.
	\end{enumerate}

	\begin{proof}
		Whenever a relation comes from the ordinary \ref{theo:lifting-property}, we denote it by $<_{LP}$ in this proof.
		\begin{description}
			\item[$v \ul s = vs \wedge w \ul s = ws$:]
			Same situation as in \ref{theo:lifting-property}.
			\item[$v \ul s = vs \wedge w \ul s = \theta(s)ws$:]
			The first part $v \ul s = vs \leq_{LP} w$ is immediate. Suppose $s \in D_R(v)$. Then $vs \leq_{LP} ws \Rightarrow v = \theta(s)vs \leq ws \Rightarrow v \ul s = vs \leq \theta(s)ws = w \ul s$. 
			\item[$v \ul s = \theta(s)vs \wedge w \ul s = ws$:]
			We have $\theta(s)w = ws$ and therefore $\theta(s) \in D_L(w)$. Suppose $s \in D_R(v)$. Then $\theta(s) \in D_R(vs)$ and hence $v \ul s = \theta(s)vs \leq vs \leq_{LP} ws = w \ul s \leq w$. In return, suppose $s \notin D_R(v)$. Since $vs \leq_{LP} w$ and $\theta(s) \in D_L(w)$ we can apply the left analogue of \ref{theo:lifting-property} on $vs,w,\theta(s)$ to get $v \ul s = \theta(s)vs \leq_{LP} w$.
			\item[$v \ul s = \theta(s)vs \wedge w \ul s = \theta(s)ws$:]
			Let $s \in D_R(w)$. Then $vs \leq_{LP} ws$. Since $\theta(s) \in D_L(vs)$ and $\theta(s) \in D_L(ws)$ we can apply the left-sided \ref{theo:lifting-property} to get $v \ul s = \theta(s)vs \leq_{LP} \theta(s)ws = w \ul s \leq w$. In return, let $s \notin D_R(w)$. Since $l(\theta(s)ws) = l(w) - 2$ we have $\theta(s) \in D_L(w)$. So we can use the \ref{theo:lifting-property} to get $vs \leq_{LP} w$ and then with the left-sided  \ref{theo:lifting-property} $v \ul s = \theta(s)vs \leq_{LP}$ w. \qedhere
		\end{description}
	\end{proof}
\end{lemm}

\begin{prop}[Exchange property for twisted expressions]
	\namedlabel{prop:exchanged-property-for-twisted-expressions}
	\theocite{Proposition 3.10}{hultman:comb-twisted-invo}
	Suppose $\ul s_1 \ldots \ul s_k$ is a reduced twisted expression. If $\rho(\ul s_1 \ldots \ul s_k \ul s) < k$ for some $s \in S$, then
	$\ul s_1 \ldots \ul s_k \ul s = \ul s_1 \ldots \ul{\hat s}_i \ldots \ul s_k$
	for some $i \in \{1,\ldots,k\}$.
\end{prop}

\begin{coro}[Deletion property for twisted expressions]
	\namedlabel{coro:deletion-property-for-twisted-expressions}
	\theocite{Proposition 3.11}{hultman:comb-twisted-invo}
	Let $w = s_1 \ldots \ul s_k$ be a not reduced twisted expression. Then there are two indices $1 \leq i < j \leq k$ such that $w = \ul s_1 \ldots \ul{\hat s}_i \ldots \ul{\hat s}_j \ldots \ul s_k$.

	\begin{proof}
		Choose $j$ minimal, so $\ul s_1 \ldots \ul s_j$ is not reduced. By \ref{prop:exchanged-property-for-twisted-expressions} there is an index $i$ with $\ul s_1 \ldots \ul s_j = s_1 \ldots \ul{\hat s}_i \ldots \ul s_{j-1}$ yielding our hypothesis $w = \ul s_1 \ldots \ul s_j \ldots \ul s_k = \ul s_1 \ldots \ul{\hat s}_i \ldots \ul{\hat s}_j \ldots \ul s_k$.
	\end{proof}
\end{coro}

When applying the \ref{prop:exchanged-property-for-twisted-expressions} to a twisted expression, there is no hint which $\ul s_i$ can be omitted. Consider the following situation: let $w \in \ti{\theta}$ and $w \ul s_1 \ldots \ul s_k = w \ul t_1 \ldots \ul t_k$ two reduced twisted expressions. Then in the twisted expression $w \ul s_1 \ldots \ldots \ul s_k \ul t_k$ we can omit the $\ul t_k$ and one other $\ul s$ by \ref{prop:exchanged-property-for-twisted-expressions} and get still the same element. It would be nice, when the second omitted $\ul s$ is one of the $\ul s_i$ in general, but unfortunately this proves to be false.

\begin{exam}
	\typedlabel{exam:wk-prefix-hypothesis}
	Let $W = A_3$, $\theta = \id$ and $w = \ul s_3$. Then $w \ul s_2 \ul s_1 \ul s_2 = w \ul s_1 \ul s_2 \ul s_3$, but $w \ul s_1 \ul s_2 \ul s_3 \ul s_2 \notin \{ w \ul s_1 \ul s_2, w \ul s_1 \ul s_3, w \ul s_2 \ul s_3 \}$. Hence the omission cannot be chosen after the prefix $w$, but at least $w \ul s_1 \ul s_2 \ul s_3 \ul s_2 = \ul s_1 \ul s_2 \ul s_3$ works, as guaranteed by \ref{prop:exchanged-property-for-twisted-expressions}.
\end{exam}